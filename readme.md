# é¡¹ç›®ä»‹ç»
åŸå…ˆçš„é¡¹ç›®æ„æ€æ˜¯é€šè¿‡æ‘„åƒå¤´æ”¶é›†äººè„¸æƒ…ç»ªè¿›è¡Œè¯†åˆ«è¿›è€Œæ™ºèƒ½æ›´æ¢éŸ³ä¹æ­Œæ›²ï¼Œä½†ç”±äºæƒ…ç»ªè¯†åˆ«å¾€å¾€æ˜¯ä¸€ç¬é—´çš„æƒ…æ„Ÿï¼ˆæˆ‘ä»¬å¾ˆå°‘ä¼šä¸€ç›´ç¬‘ï¼Œä¸€ç›´æ¿€åŠ¨ï¼Œæœ‰å¯èƒ½ä¸Šä¸€ç§’æœºå™¨è¯†åˆ«åˆ°æƒ…ç»ªä¸ºé«˜å…´è€Œæ”¾å–œåº†çš„éŸ³ä¹ï¼Œä½†ä¸‹ä¸€ç§’æˆ‘ä»¬çš„æƒ…ç»ªå·²ç»å¹³å¤å¯¼è‡´åŸæœ¬å°†è¦æ’­æ”¾çš„æ­Œæ›²ä¸€ä¸‹å­åˆæ›´æ¢äº†ï¼Œä¹Ÿå¯èƒ½æ”¾åˆ°é«˜æ½®éƒ¨åˆ†å› ä¸ºæƒ…ç»ªçš„é”™è¯¯è¯†åˆ«è€Œå°†æ­Œæ›²æ›¿æ¢ï¼Œå¯¼è‡´æ•ˆæœä¸ä½³ï¼Œæ‰€ä»¥æœ€ç»ˆå†³å®šé‡‡ç”¨æ›´ä¸ºç¨³å®šçš„æ‰‹åŠ¿è¯†åˆ«æ–¹å¼æ¥è¿›è¡Œå¯¹éŸ³ä¹æ’­æ”¾å™¨çš„æ§åˆ¶ï¼‰æœ¬é¡¹ç›®æ—¨åœ¨é€šè¿‡æ‰‹åŠ¿è¯†åˆ«æ¥æ§åˆ¶éŸ³ä¹æ’­æ”¾å™¨ï¼Œä»¥æ»¡è¶³æŸäº›åœºåˆä¸‹ï¼Œä¸æ–¹ä¾¿ç›´æ¥æ“æ§éŸ³ä¹è½¯ä»¶çš„éœ€æ±‚ã€‚

# çµæ„Ÿæ¥æº
    åœ¨ä¸€äº›å…¬å…±çš„åœºåˆå¦‚ç†å‘åº—ã€å¥¶èŒ¶åº—ã€é¤å…ç­‰éƒ½ä¼šæ’­æ”¾éŸ³ä¹æ¥è°ƒèŠ‚æ°”æ°›ï¼Œè€ŒéŸ³ä¹çš„æ§åˆ¶æ–¹å¼æ˜¯ç›´æ¥è¿ç”¨ç”µè„‘æ¥æ“æ§ï¼ˆå›ºå®šä½ç½®æ“æ§ï¼‰ï¼Œæœ‰æ—¶å€™ç¢°åˆ°ä¸æƒ³å¬çš„ã€è®©å®¢äººåæ„Ÿçš„æ­Œæ›²ï¼Œæˆ–è€…æ­Œæ›²éŸ³é‡è¿‡å¤§è¿‡ä½çš„æƒ…å†µï¼Œå¾€å¾€éœ€è¦å·¥ä½œäººå‘˜äº²è‡ªè¿‡å»æ›´æ¢ï¼Œå¦‚æœæ­£åœ¨å¿™èµ°ä¸å¼€ï¼Œä¹Ÿåªèƒ½ç­‰æ­Œæ›²æ’­æ”¾å®Œè‡ªåŠ¨åˆ‡æ¢ï¼ˆå¦‚ç†å‘å¸ˆæ­£åœ¨ç†å‘ã€æœåŠ¡å‘˜æ­£åœ¨ä¸ºå®¢æˆ·ç‚¹é¤ï¼‰ï¼Œä¸ºäº†ä½¿ç”¨æˆ·çš„ä½“éªŒæ›´ä½³ï¼Œå¹¶ä¸”ç»™äºˆå®¢äººå¯¹éŸ³ä¹ç¯å¢ƒçš„æ§åˆ¶æƒåŠ›ï¼ˆå®¢äººä¹Ÿå¯ä»¥é€šè¿‡è‡ªå·±çš„æ‰‹åŠ¿æ¥æ§åˆ¶éŸ³ä¹çš„æ’­æ”¾åŠåˆ‡æ¢ï¼‰ï¼Œæˆ‘æƒ³éƒ¨ç½²ä¸€ä¸ªå¯ä»¥é€šè¿‡æ‰‹åŠ¿æ§åˆ¶çš„æ™ºèƒ½éŸ³ä¹ç›’åœ¨æ­¤ç±»åœºæ™¯ï¼Œä¾¿äºå¯¹èƒŒæ™¯éŸ³ä¹è¿›è¡Œæ§åˆ¶ï¼ŒåæœŸå°†åŸºäºæ–‡å­—è¯†åˆ«æ¨¡å‹ï¼Œè®©ç”¨æˆ·å¯è‡ªè¡Œç‚¹æ­Œï¼ˆå®¢æˆ·å¯¹éŸ³ä¹ç›’æ‘„åƒå¤´å±•ç°å‡ºæƒ³å¬çš„æ­Œæ›²åå­—ï¼Œæœºå™¨è¿›è¡Œè¯†åˆ«æ’­æ”¾ï¼‰ã€‚

# ä¸€ã€æ•°æ®é›†è¯´æ˜

* æœ¬é¡¹ç›®ä½¿ç”¨çš„æ•°æ®é›†æ˜¯ï¼šè‡ªå®šä¹‰çš„æ‰‹åŠ¿æ•°æ®é›†ï¼Œæ•°æ®æ¥æºäºaistudioä¸­çš„å…¬å¼€æ•°æ®é›†ï¼Œå¹¶å°†è¿™äº›æ•°æ®é›†è¿›è¡Œé‡æ–°æ•´åˆã€‚æ¯ä¸€ç§æ‰‹åŠ¿å¯¹åº”ä¸€ç§éŸ³ä¹æ’­æ”¾å™¨çš„æ§åˆ¶æ“ä½œã€‚

è¯¥æ•°æ®é›†å·²åŠ è½½è‡³æœ¬ç¯å¢ƒä¸­ï¼Œä½äºï¼š**data/data103092/hand-music.zip**


```python
## è§£å‹æ•°æ®é›†ï¼ˆè§£å‹ä¸€æ¬¡å³å¯ï¼Œè¯·å‹¿é‡å¤è§£å‹ï¼‰
!unzip -q -o data/data103092/hand-music.zip
```

è§£å‹å®Œæˆåï¼Œå·¦ä¾§æ–‡ä»¶å¤¹å¤„ä¼šå¤šä¸€ä¸ªåä¸ºhand-musicçš„æ–‡ä»¶å¤¹ï¼Œè¯¥æ–‡ä»¶å¤¹ä¸‹æœ‰2ä¸ªå­æ–‡ä»¶å¤¹ï¼š

1. **Annotationså›¾åƒæ–‡ä»¶**
1. **Annotationsæ ‡æ³¨æ–‡ä»¶**



```python
# æŸ¥çœ‹æ•°æ®é›†æ–‡ä»¶ç»“æ„
!tree hand-music -L 1
```

    hand-music
    â”œâ”€â”€ Annotations
    â””â”€â”€ JPEGImages
    
    2 directories, 0 files


# äºŒã€æ•°æ®å‡†å¤‡

æœ¬åŸºçº¿ç³»ç»Ÿä½¿ç”¨çš„æ•°æ®æ ¼å¼æ˜¯PascalVOCæ ¼å¼ï¼Œå¼€å‘è€…åŸºäºPaddleXå¼€å‘ç›®æ ‡æ£€æµ‹æ¨¡å‹æ—¶ï¼Œæ— éœ€å¯¹æ•°æ®æ ¼å¼è¿›è¡Œè½¬æ¢ï¼Œå¼€ç®±å³ç”¨ã€‚

ä½†ä¸ºäº†è¿›è¡Œè®­ç»ƒï¼Œè¿˜éœ€è¦å°†æ•°æ®åˆ’åˆ†ä¸ºè®­ç»ƒé›†ã€éªŒè¯é›†å’Œæµ‹è¯•é›†ã€‚åˆ’åˆ†ä¹‹å‰é¦–å…ˆéœ€è¦**å®‰è£…PaddleX**ã€‚


```python
#å®‰è£…paddlex
!pip install paddlex
```

    Looking in indexes: https://mirror.baidu.com/pypi/simple/
    Collecting paddlex
    [?25l  Downloading https://mirror.baidu.com/pypi/packages/d6/a2/07435f4aa1e51fe22bdf06c95d03bf1b78b7bc6625adbb51e35dc0804cc7/paddlex-1.3.11-py3-none-any.whl (516kB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 522kB 12.9MB/s eta 0:00:01
    [?25hCollecting xlwt (from paddlex)
    [?25l  Downloading https://mirror.baidu.com/pypi/packages/44/48/def306413b25c3d01753603b1a222a011b8621aed27cd7f89cbc27e6b0f4/xlwt-1.3.0-py2.py3-none-any.whl (99kB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 102kB 24.2MB/s ta 0:00:01
    [?25hRequirement already satisfied: opencv-python in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlex) (4.1.1.26)
    Collecting pycocotools; platform_system != "Windows" (from paddlex)
      Downloading https://mirror.baidu.com/pypi/packages/de/df/056875d697c45182ed6d2ae21f62015896fdb841906fe48e7268e791c467/pycocotools-2.0.2.tar.gz
    Requirement already satisfied: psutil in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlex) (5.7.2)
    Collecting shapely>=1.7.0 (from paddlex)
    [?25l  Downloading https://mirror.baidu.com/pypi/packages/98/f8/db4d3426a1aba9d5dfcc83ed5a3e2935d2b1deb73d350642931791a61c37/Shapely-1.7.1-cp37-cp37m-manylinux1_x86_64.whl (1.0MB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1.0MB 14.9MB/s eta 0:00:01
    [?25hCollecting paddlehub==2.1.0 (from paddlex)
    [?25l  Downloading https://mirror.baidu.com/pypi/packages/7a/29/3bd0ca43c787181e9c22fe44b944b64d7fcb14ce66d3bf4602d9ad2ac76c/paddlehub-2.1.0-py3-none-any.whl (211kB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 215kB 29.1MB/s eta 0:00:01
    [?25hRequirement already satisfied: sklearn in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlex) (0.0)
    Requirement already satisfied: tqdm in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlex) (4.36.1)
    Requirement already satisfied: flask-cors in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlex) (3.0.8)
    Requirement already satisfied: colorama in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlex) (0.4.4)
    Collecting paddleslim==1.1.1 (from paddlex)
    [?25l  Downloading https://mirror.baidu.com/pypi/packages/d1/77/e257227bed9a70ff0d35a4a3c4e70ac2d2362c803834c4c52018f7c4b762/paddleslim-1.1.1-py2.py3-none-any.whl (145kB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 153kB 28.3MB/s eta 0:00:01
    [?25hRequirement already satisfied: visualdl>=2.0.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlex) (2.2.0)
    Requirement already satisfied: pyyaml in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlex) (5.1.2)
    Requirement already satisfied: numpy>=1.14.5 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from opencv-python->paddlex) (1.20.3)
    Requirement already satisfied: setuptools>=18.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from pycocotools; platform_system != "Windows"->paddlex) (56.2.0)
    Requirement already satisfied: cython>=0.27.3 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from pycocotools; platform_system != "Windows"->paddlex) (0.29)
    Requirement already satisfied: matplotlib>=2.1.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from pycocotools; platform_system != "Windows"->paddlex) (2.2.3)
    Requirement already satisfied: rarfile in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlehub==2.1.0->paddlex) (3.1)
    Requirement already satisfied: packaging in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlehub==2.1.0->paddlex) (20.9)
    Requirement already satisfied: flask>=1.1.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlehub==2.1.0->paddlex) (1.1.1)
    Requirement already satisfied: pyzmq in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlehub==2.1.0->paddlex) (18.1.1)
    Requirement already satisfied: easydict in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlehub==2.1.0->paddlex) (1.9)
    Requirement already satisfied: colorlog in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlehub==2.1.0->paddlex) (4.1.0)
    Requirement already satisfied: filelock in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlehub==2.1.0->paddlex) (3.0.12)
    Collecting paddle2onnx>=0.5.1 (from paddlehub==2.1.0->paddlex)
    [?25l  Downloading https://mirror.baidu.com/pypi/packages/37/80/aa6134b5f36aea45dc1b363e7af941dccabe4d7e167ac391ff046f34baf1/paddle2onnx-0.7-py3-none-any.whl (94kB)
    [K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 102kB 32.2MB/s ta 0:00:01
    [?25hRequirement already satisfied: gunicorn>=19.10.0; sys_platform != "win32" in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlehub==2.1.0->paddlex) (20.0.4)
    Requirement already satisfied: paddlenlp>=2.0.0rc5 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlehub==2.1.0->paddlex) (2.0.0rc7)
    Requirement already satisfied: gitpython in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlehub==2.1.0->paddlex) (3.1.14)
    Requirement already satisfied: Pillow in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlehub==2.1.0->paddlex) (7.1.2)
    Requirement already satisfied: scikit-learn in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from sklearn->paddlex) (0.24.2)
    Requirement already satisfied: Six in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from flask-cors->paddlex) (1.15.0)
    Requirement already satisfied: protobuf>=3.11.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from visualdl>=2.0.0->paddlex) (3.14.0)
    Requirement already satisfied: pre-commit in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from visualdl>=2.0.0->paddlex) (1.21.0)
    Requirement already satisfied: requests in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from visualdl>=2.0.0->paddlex) (2.22.0)
    Requirement already satisfied: pandas in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from visualdl>=2.0.0->paddlex) (1.1.5)
    Requirement already satisfied: flake8>=3.7.9 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from visualdl>=2.0.0->paddlex) (3.8.2)
    Requirement already satisfied: bce-python-sdk in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from visualdl>=2.0.0->paddlex) (0.8.53)
    Requirement already satisfied: shellcheck-py in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from visualdl>=2.0.0->paddlex) (0.7.1.1)
    Requirement already satisfied: Flask-Babel>=1.0.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from visualdl>=2.0.0->paddlex) (1.0.0)
    Requirement already satisfied: python-dateutil>=2.1 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from matplotlib>=2.1.0->pycocotools; platform_system != "Windows"->paddlex) (2.8.0)
    Requirement already satisfied: cycler>=0.10 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from matplotlib>=2.1.0->pycocotools; platform_system != "Windows"->paddlex) (0.10.0)
    Requirement already satisfied: kiwisolver>=1.0.1 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from matplotlib>=2.1.0->pycocotools; platform_system != "Windows"->paddlex) (1.1.0)
    Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,>=2.0.1 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from matplotlib>=2.1.0->pycocotools; platform_system != "Windows"->paddlex) (2.4.2)
    Requirement already satisfied: pytz in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from matplotlib>=2.1.0->pycocotools; platform_system != "Windows"->paddlex) (2019.3)
    Requirement already satisfied: Werkzeug>=0.15 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from flask>=1.1.0->paddlehub==2.1.0->paddlex) (0.16.0)
    Requirement already satisfied: itsdangerous>=0.24 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from flask>=1.1.0->paddlehub==2.1.0->paddlex) (1.1.0)
    Requirement already satisfied: Jinja2>=2.10.1 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from flask>=1.1.0->paddlehub==2.1.0->paddlex) (2.10.1)
    Requirement already satisfied: click>=5.1 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from flask>=1.1.0->paddlehub==2.1.0->paddlex) (7.0)
    Requirement already satisfied: seqeval in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlenlp>=2.0.0rc5->paddlehub==2.1.0->paddlex) (1.2.2)
    Requirement already satisfied: jieba in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlenlp>=2.0.0rc5->paddlehub==2.1.0->paddlex) (0.42.1)
    Requirement already satisfied: h5py in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from paddlenlp>=2.0.0rc5->paddlehub==2.1.0->paddlex) (2.9.0)
    Requirement already satisfied: gitdb<5,>=4.0.1 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from gitpython->paddlehub==2.1.0->paddlex) (4.0.5)
    Requirement already satisfied: scipy>=0.19.1 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from scikit-learn->sklearn->paddlex) (1.6.3)
    Requirement already satisfied: joblib>=0.11 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from scikit-learn->sklearn->paddlex) (0.14.1)
    Requirement already satisfied: threadpoolctl>=2.0.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from scikit-learn->sklearn->paddlex) (2.1.0)
    Requirement already satisfied: aspy.yaml in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from pre-commit->visualdl>=2.0.0->paddlex) (1.3.0)
    Requirement already satisfied: cfgv>=2.0.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from pre-commit->visualdl>=2.0.0->paddlex) (2.0.1)
    Requirement already satisfied: toml in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from pre-commit->visualdl>=2.0.0->paddlex) (0.10.0)
    Requirement already satisfied: virtualenv>=15.2 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from pre-commit->visualdl>=2.0.0->paddlex) (16.7.9)
    Requirement already satisfied: identify>=1.0.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from pre-commit->visualdl>=2.0.0->paddlex) (1.4.10)
    Requirement already satisfied: nodeenv>=0.11.1 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from pre-commit->visualdl>=2.0.0->paddlex) (1.3.4)
    Requirement already satisfied: importlib-metadata; python_version < "3.8" in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from pre-commit->visualdl>=2.0.0->paddlex) (0.23)
    Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from requests->visualdl>=2.0.0->paddlex) (1.25.6)
    Requirement already satisfied: certifi>=2017.4.17 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from requests->visualdl>=2.0.0->paddlex) (2019.9.11)
    Requirement already satisfied: chardet<3.1.0,>=3.0.2 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from requests->visualdl>=2.0.0->paddlex) (3.0.4)
    Requirement already satisfied: idna<2.9,>=2.5 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from requests->visualdl>=2.0.0->paddlex) (2.8)
    Requirement already satisfied: mccabe<0.7.0,>=0.6.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from flake8>=3.7.9->visualdl>=2.0.0->paddlex) (0.6.1)
    Requirement already satisfied: pyflakes<2.3.0,>=2.2.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from flake8>=3.7.9->visualdl>=2.0.0->paddlex) (2.2.0)
    Requirement already satisfied: pycodestyle<2.7.0,>=2.6.0a1 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from flake8>=3.7.9->visualdl>=2.0.0->paddlex) (2.6.0)
    Requirement already satisfied: pycryptodome>=3.8.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from bce-python-sdk->visualdl>=2.0.0->paddlex) (3.9.9)
    Requirement already satisfied: future>=0.6.0 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from bce-python-sdk->visualdl>=2.0.0->paddlex) (0.18.0)
    Requirement already satisfied: Babel>=2.3 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from Flask-Babel>=1.0.0->visualdl>=2.0.0->paddlex) (2.8.0)
    Requirement already satisfied: MarkupSafe>=0.23 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from Jinja2>=2.10.1->flask>=1.1.0->paddlehub==2.1.0->paddlex) (1.1.1)
    Requirement already satisfied: smmap<4,>=3.0.1 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from gitdb<5,>=4.0.1->gitpython->paddlehub==2.1.0->paddlex) (3.0.5)
    Requirement already satisfied: zipp>=0.5 in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from importlib-metadata; python_version < "3.8"->pre-commit->visualdl>=2.0.0->paddlex) (0.6.0)
    Requirement already satisfied: more-itertools in /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages (from zipp>=0.5->importlib-metadata; python_version < "3.8"->pre-commit->visualdl>=2.0.0->paddlex) (7.2.0)
    Building wheels for collected packages: pycocotools
      Building wheel for pycocotools (setup.py) ... [?25ldone
    [?25h  Created wheel for pycocotools: filename=pycocotools-2.0.2-cp37-cp37m-linux_x86_64.whl size=278362 sha256=040b3946276260ad69d71d529cd6d51bfda0ffc3573ac2ec3d996fa5b10b805c
      Stored in directory: /home/aistudio/.cache/pip/wheels/fb/44/67/8baa69040569b1edbd7776ec6f82c387663e724908aaa60963
    Successfully built pycocotools
    Installing collected packages: xlwt, pycocotools, shapely, paddle2onnx, paddlehub, paddleslim, paddlex
      Found existing installation: paddlehub 2.0.4
        Uninstalling paddlehub-2.0.4:
          Successfully uninstalled paddlehub-2.0.4
    Successfully installed paddle2onnx-0.7 paddlehub-2.1.0 paddleslim-1.1.1 paddlex-1.3.11 pycocotools-2.0.2 shapely-1.7.1 xlwt-1.3.0



```python
#è°ƒç”¨ä¸€äº›è¦ç”¨åˆ°çš„åº“
import paddlex as pdx
import cv2
import numpy as np
```

    /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/paddle/fluid/layers/utils.py:26: DeprecationWarning: `np.int` is a deprecated alias for the builtin `int`. To silence this warning, use `int` by itself. Doing this will not modify any behavior and is safe. When replacing `np.int`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
    Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
      def convert_to_list(value, n, name, dtype=np.int):


ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å³å¯å°†æ•°æ®åˆ’åˆ†ä¸º70%è®­ç»ƒé›†ï¼Œ20%éªŒè¯é›†å’Œ10%çš„æµ‹è¯•é›†ã€‚


```python
!paddlex --split_dataset --format VOC --dataset_dir hand-music --val_value 0.2 --test_value 0.1
```

    /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/paddle/fluid/layers/utils.py:26: DeprecationWarning: `np.int` is a deprecated alias for the builtin `int`. To silence this warning, use `int` by itself. Doing this will not modify any behavior and is safe. When replacing `np.int`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
    Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
      def convert_to_list(value, n, name, dtype=np.int):
    Dataset Split Done.
    Train samples: 883
    Eval samples: 251
    Test samples: 125
    Split files saved in hand-music



```python
#æ•°æ®åˆ’åˆ†æ•ˆæœ
!tree hand-music -L 1
```

    hand-music
    â”œâ”€â”€ Annotations
    â”œâ”€â”€ JPEGImages
    â”œâ”€â”€ labels.txt
    â”œâ”€â”€ test_list.txt
    â”œâ”€â”€ train_list.txt
    â””â”€â”€ val_list.txt
    
    2 directories, 4 files


# ä¸‰ã€æ•°æ®é¢„å¤„ç†

åœ¨è®­ç»ƒæ¨¡å‹ä¹‹å‰ï¼Œå¯¹ç›®æ ‡æ£€æµ‹ä»»åŠ¡çš„æ•°æ®è¿›è¡Œæ“ä½œï¼Œä»è€Œæå‡æ¨¡å‹æ•ˆæœã€‚å¯ç”¨äºæ•°æ®å¤„ç†çš„APIæœ‰ï¼š
- **Normalize**ï¼šå¯¹å›¾åƒè¿›è¡Œå½’ä¸€åŒ–
- **ResizeByShort**ï¼šæ ¹æ®å›¾åƒçš„çŸ­è¾¹è°ƒæ•´å›¾åƒå¤§å°
- **RandomHorizontalFlip**ï¼šä»¥ä¸€å®šçš„æ¦‚ç‡å¯¹å›¾åƒè¿›è¡Œéšæœºæ°´å¹³ç¿»è½¬
- **RandomDistort**ï¼šä»¥ä¸€å®šçš„æ¦‚ç‡å¯¹å›¾åƒè¿›è¡Œéšæœºåƒç´ å†…å®¹å˜æ¢

æ›´å¤šå…³äºæ•°æ®å¤„ç†çš„APIåŠä½¿ç”¨è¯´æ˜å¯æŸ¥çœ‹æ–‡æ¡£ï¼š
[https://paddlex.readthedocs.io/zh_CN/release-1.3/apis/transforms/det_transforms.html](https://paddlex.readthedocs.io/zh_CN/release-1.3/apis/transforms/det_transforms.html)


```python
from paddlex.det import transforms
# å®šä¹‰è®­ç»ƒå’ŒéªŒè¯æ—¶çš„transforms
# APIè¯´æ˜ https://paddlex.readthedocs.io/zh_CN/develop/apis/transforms/det_transforms.html
train_transforms = transforms.Compose([
    # æ­¤å¤„éœ€è¦è¡¥å……å›¾åƒé¢„å¤„ç†ä»£ç 
    transforms.Resize(target_size=608, interp='LINEAR'),
    transforms.RandomHorizontalFlip(prob=0.5),
    transforms.Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225], min_val=[0., 0., 0.], max_val=[255., 255., 255.])

])

eval_transforms = transforms.Compose([
    # æ­¤å¤„éœ€è¦è¡¥å……å›¾åƒé¢„å¤„ç†ä»£ç 
    transforms.Resize(target_size=608, interp='LINEAR'),
    transforms.Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225], min_val=[0., 0., 0.], max_val=[255., 255., 255.])
])


```


```python
# å®šä¹‰è®­ç»ƒå’ŒéªŒè¯æ‰€ç”¨çš„æ•°æ®é›†
train_dataset = pdx.datasets.VOCDetection(
    data_dir='hand-music',
    file_list='hand-music/train_list.txt',
    label_list='hand-music/labels.txt',
    transforms=train_transforms,
    shuffle=True)

eval_dataset = pdx.datasets.VOCDetection(
    data_dir='hand-music',
    file_list='hand-music/val_list.txt',
    label_list='hand-music/labels.txt',
    transforms=eval_transforms,
    shuffle=False)
```

    /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/__init__.py:107: DeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated, and in 3.8 it will stop working
      from collections import MutableMapping
    /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/rcsetup.py:20: DeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated, and in 3.8 it will stop working
      from collections import Iterable, Mapping
    /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/colors.py:53: DeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated, and in 3.8 it will stop working
      from collections import Sized
    2021-08-16 15:35:34,868 - INFO - font search path ['/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/mpl-data/fonts/ttf', '/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/mpl-data/fonts/afm', '/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/mpl-data/fonts/pdfcorefonts']
    2021-08-16 15:35:35,288 - INFO - generated new fontManager


    2021-08-16 15:35:35 [INFO]	Starting to read file list from dataset...
    2021-08-16 15:35:36 [INFO]	883 samples in file hand-music/train_list.txt
    creating index...
    index created!
    2021-08-16 15:35:36 [INFO]	Starting to read file list from dataset...
    2021-08-16 15:35:36 [INFO]	251 samples in file hand-music/val_list.txt
    creating index...
    index created!


# å››ã€æ¨¡å‹è®­ç»ƒ

PaddleXç›®å‰æä¾›äº†FasterRCNNå’ŒYOLOv3ä¸¤ç§æ£€æµ‹ç»“æ„ï¼Œå¤šç§backboneæ¨¡å‹ã€‚æœ¬åŸºçº¿ç³»ç»Ÿä»¥éª¨å¹²ç½‘ç»œä¸ºMobileNetV1çš„YOLOv3ç®—æ³•ä¸ºä¾‹ã€‚


```python
#åˆå§‹åŒ–æ¨¡å‹
num_classes = len(train_dataset.labels)
model = pdx.det.YOLOv3(num_classes=num_classes, backbone='MobileNetV1')
```


```python
#æ¨¡å‹è®­ç»ƒåŠç›¸å…³å‚æ•°
model.train(
    num_epochs=270,
    train_dataset=train_dataset,
    train_batch_size=2,
    eval_dataset=eval_dataset,
    learning_rate=0.001 / 8,
    warmup_steps=1000,
    warmup_start_lr=0.0,
    save_interval_epochs=1,
    lr_decay_epochs=[210,240],
    save_dir='output/yolov3_mobilenet',
    use_vdl='ture'
    )
```

# äº”ã€æ¨¡å‹æ£€æµ‹
ç”Ÿæˆresult.txtè®°å½•ç»“æœ


```python
image_name = 'test1.jpg'
# æ¨¡å‹ä¿å­˜ä½ç½®
model = pdx.load_model('output/yolov3_mobilenet/best_model')

img = cv2.imread(image_name)
result = model.predict(img)


keep_results = []
areas = []
f = open('./output/yolov3_mobilenet/result.txt', 'a')
for dt in np.array(result):
    cname, bbox, score = dt['category'], dt['bbox'], dt['score']
    if score < 0.5:                    #å‡†ç¡®ç‡ä½äº0.5çš„ç»“æœä¸è®°å½•
        continue
    keep_results.append(dt)
    f.write(str(dt) + '\n')
    f.write('\n')
    areas.append(bbox[2] * bbox[3])
areas = np.asarray(areas)
sorted_idxs = np.argsort(-areas).tolist()
keep_results = [keep_results[k]
                for k in sorted_idxs] if len(keep_results) > 0 else []
print(keep_results)
f.close()

```

    2021-08-16 15:36:07 [INFO]	Model[YOLOv3] loaded.
    [{'category_id': 2, 'bbox': [40.198211669921875, 4.55499267578125, 236.2442626953125, 326.3627014160156], 'score': 0.7120435237884521, 'category': 'pause'}]


# å…­ã€æ¨¡å‹å¯¼å‡º
æ¨¡å‹å¯¼å‡ºç»“æœä½äºinference_modelæ–‡ä»¶ä¸­


```python
!paddlex --export_inference --model_dir=output/yolov3_mobilenet/best_model --save_dir=./inference_model
```

    /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/paddle/fluid/layers/utils.py:26: DeprecationWarning: `np.int` is a deprecated alias for the builtin `int`. To silence this warning, use `int` by itself. Doing this will not modify any behavior and is safe. When replacing `np.int`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
    Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
      def convert_to_list(value, n, name, dtype=np.int):
    W0816 15:36:21.716179   993 device_context.cc:362] Please NOTE: device: 0, GPU Compute Capability: 7.0, Driver API Version: 10.1, Runtime API Version: 10.1
    W0816 15:36:21.720713   993 device_context.cc:372] device: 0, cuDNN Version: 7.6.
    2021-08-16 15:36:27 [INFO]	Model[YOLOv3] loaded.
    2021-08-16 15:36:27 [INFO]	Model for inference deploy saved in ./inference_model.



```python
#æµ‹è¯•å¯¼å‡ºæ¨¡å‹
image_name = 'test1.jpg'
# æ¨¡å‹ä¿å­˜ä½ç½®
model = pdx.load_model('inference_model')

img = cv2.imread(image_name)
result = model.predict(img)


keep_results = []
areas = []
f = open('./output/yolov3_mobilenet/result.txt', 'a')
for dt in np.array(result):
    cname, bbox, score = dt['category'], dt['bbox'], dt['score']
    if score < 0.3:
        continue
    keep_results.append(dt)
    f.write(str(dt) + '\n')
    f.write('\n')
    areas.append(bbox[2] * bbox[3])
areas = np.asarray(areas)
sorted_idxs = np.argsort(-areas).tolist()
keep_results = [keep_results[k]
                for k in sorted_idxs] if len(keep_results) > 0 else []
print(keep_results)
f.close()

```

    2021-08-16 15:36:44 [INFO]	Model[YOLOv3] loaded.
    [{'category_id': 2, 'bbox': [40.198211669921875, 4.55499267578125, 236.2442626953125, 326.3627014160156], 'score': 0.7120435237884521, 'category': 'pause'}]


# ä¸ƒã€ç»“æœå¯è§†åŒ–
å¯¼å‡ºæµ‹è¯•ç»“æœä½äºæ ¹ç›®å½•ä¸‹


```python
#ç»“æœå¯è§†åŒ–
image_name = 'test1.jpg'
img = cv2.imread(image_name)
pdx.det.visualize(img, result, threshold=0, save_dir='./', color=None)
```

    /opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/cbook/__init__.py:2349: DeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated, and in 3.8 it will stop working
      if isinstance(obj, collections.Iterator):


    2021-08-16 15:36:48 [INFO]	The visualized result is saved as ./visualize_1629099408886.jpg



```python
#æ¨¡å‹ç”Ÿæˆå‹ç¼©åŒ… ä¸‹è½½åˆ°æœ¬åœ°éƒ¨ç½²
!zip -r inference_model.zip inference_model
```

      adding: inference_model/ (stored 0%)
      adding: inference_model/.success (stored 0%)
      adding: inference_model/__params__ (deflated 7%)
      adding: inference_model/model.yml (deflated 50%)
      adding: inference_model/__model__ (deflated 96%)


# å…«ã€æœ¬åœ°ç®€å•éƒ¨ç½²æˆæœ
[è§†é¢‘](https://www.bilibili.com/video/BV1uM4y1L763/)
<iframe style="width:100%;height: 640px;" src="//player.bilibili.com/player.html?aid=588161536&bvid=BV1uM4y1L763&cid=340211724&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> 


#éŸ³ä¹æ’­æ”¾å™¨ä»£ç ä½äºdata/Music Player.zipä¸­
[ä»£ç æ¥æº](https://blog.csdn.net/qq_44614026/article/details/88833953?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522162895165116780265427641%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=162895165116780265427641&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v29-2-88833953.ecpm_v1_rank_v29&utm_term=python%E9%9F%B3%E4%B9%90%E6%92%AD%E6%94%BE%E5%99%A8&spm=1018.2226.3001.4187)
é¡¹ç›®ä¸­çš„éŸ³ä¹æ’­æ”¾å™¨åœ¨ä»…åœ¨ä¸Šè¿°æ’­æ”¾å™¨åŸºç¡€ä¸Šæ·»åŠ äº†æ‰‹åŠ¿è¯†åˆ«åŠŸèƒ½


# ä¹ã€å¼€å‘è¿‡ç¨‹é‡åˆ°çš„é—®é¢˜
1. æ¨¡å‹ç²¾ç¡®åº¦ä¸å¤Ÿé«˜ï¼Œå®¹æ˜“å‡ºç°é”™è¯¯çš„è¯†åˆ«ï¼Œå½±å“å¯¹æ’­æ”¾å™¨çš„æ“æ§ã€‚------è¦è®­ç»ƒæ›´ç²¾ç¡®ã€é«˜æ•ˆçš„æ¨¡å‹
2. æ‘„åƒå¤´è¯»å–ä¿¡æ¯ï¼Œå¹¶äº¤ç”±æ¨¡å‹æ£€æµ‹çš„è¿‡ç¨‹éœ€è¦ä¸€å®šæ—¶é—´ï¼Œæœ€ç»ˆå¯¼è‡´æ‘„åƒå¤´è¯»å–çš„å¸§æ•°å †ç§¯ï¼Œåœ¨cv2.imshow('frame', new_img)æ—¶ï¼Œå®æ—¶å›¾åƒå»¶è¿Ÿä¸¥é‡--------------------ç½‘ä¸Šè§£å†³åŠæ³•ï¼šé‡‡ç”¨å¤šçº¿ç¨‹ï¼Œä¸€ä¸ªè¿›ç¨‹å±•ç¤ºå®æ—¶å›¾åƒï¼Œä¸€ä¸ªè¿›ç¨‹è¿›è¡Œæ•°æ®å¤„ç†ï¼Œè¾“å‡ºç»“æœã€‚


# åã€æ€»ç»“
1. æ¨¡å‹è®­ç»ƒè°ƒå‚æ˜¯æé«˜æ¨¡å‹ç²¾ç¡®åº¦çš„å…³é”®ï¼Œæœ¬é¡¹ç›®çš„æ¨¡å‹å‡†ç¡®åº¦ä¸é«˜ï¼Œå½“æœ‰å¤–ç•Œå¹²æ‰°æ—¶ï¼Œå¾ˆéš¾åšå‡ºå‡†ç¡®çš„åˆ¤æ–­ã€‚
2. æœ¬åœ°éƒ¨ç½²ç¯å¢ƒé…ç½®å¾ˆå¤æ‚ï¼Œè¿œæ¯”åœ¨aistudioä¸Šå¼€å‘å›°éš¾
3. è¦å…¨é¢å‘å±•ï¼Œè¿ç”¨å¤šçº¿ç¨‹ï¼Œè§£å†³å›¾åƒå»¶è¿Ÿé—®é¢˜ã€‚


aistudioè´¦å·
zephon993
